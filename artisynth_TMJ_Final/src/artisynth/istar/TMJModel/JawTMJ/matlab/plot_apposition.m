clc; clear; close all;

% First data (in percentage, multiplied by 100)
left_percent_1 = 100 * [0.00,0.02,0.05,0.06,0.07,0.10,0.11,0.12,0.12,0.12,0.14,0.23,0.25,0.28,0.32,0.34,0.37,0.39,0.42,0.44,0.45,0.48,0.51,0.54,0.56,0.59,0.61,0.63,0.66,0.69,0.71,0.74,0.76,0.78,0.79,0.80,0.80,0.80,0.80,0.80,0.80,0.79,0.78,0.78,0.77,0.77,0.76,0.74,0.72,0.70,0.65,0.59,0.55,0.51,0.32,0.21,0.04,0.04,0.02,0.00,0.00,0.00,0.00];
right_percent_1 = 100 * [0.00,0.04,0.07,0.10,0.11,0.16,0.17,0.17,0.17,0.17,0.19,0.32,0.36,0.37,0.38,0.39,0.40,0.41,0.44,0.45,0.46,0.48,0.48,0.50,0.52,0.53,0.55,0.58,0.61,0.64,0.68,0.71,0.74,0.78,0.80,0.81,0.81,0.81,0.81,0.81,0.81,0.80,0.76,0.75,0.74,0.73,0.70,0.68,0.64,0.60,0.57,0.46,0.42,0.33,0.01,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00];

% Second data (in percentage, multiplied by 100)
left_percent_2 = 100 * [0.00,0.02,0.04,0.05,0.06,0.10,0.11,0.12,0.12,0.12,0.15,0.23,0.25,0.28,0.31,0.33,0.36,0.39,0.41,0.43,0.45,0.47,0.50,0.53,0.56,0.58,0.61,0.64,0.67,0.69,0.73,0.75,0.77,0.78,0.79,0.79,0.80,0.80,0.80,0.80,0.79,0.79,0.79,0.78,0.77,0.76,0.76,0.75,0.73,0.70,0.66,0.58,0.54,0.51,0.31,0.23,0.07,0.09,0.06,0.00,0.00,0.00,0.00];
right_percent_2 = 100 * [0.00,0.04,0.07,0.10,0.12,0.18,0.19,0.19,0.19,0.19,0.21,0.33,0.35,0.36,0.38,0.40,0.41,0.43,0.44,0.45,0.46,0.47,0.49,0.50,0.52,0.54,0.56,0.58,0.61,0.65,0.69,0.71,0.76,0.79,0.81,0.81,0.82,0.82,0.82,0.82,0.82,0.81,0.78,0.76,0.75,0.73,0.71,0.68,0.65,0.61,0.57,0.47,0.42,0.34,0.01,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00];

% Third data (in percentage, multiplied by 100)
left_percent_3 = 100 * [0.00,0.00,0.03,0.05,0.06,0.09,0.11,0.12,0.12,0.12,0.15,0.22,0.25,0.29,0.32,0.34,0.36,0.39,0.41,0.43,0.44,0.47,0.49,0.52,0.55,0.58,0.61,0.66,0.69,0.71,0.73,0.75,0.77,0.79,0.80,0.81,0.81,0.81,0.81,0.81,0.80,0.80,0.80,0.79,0.78,0.77,0.76,0.75,0.74,0.72,0.67,0.58,0.54,0.52,0.35,0.25,0.10,0.20,0.23,0.00,0.00,0.00,0.00];
right_percent_3 = 100 * [0.00,0.03,0.07,0.10,0.11,0.17,0.18,0.18,0.18,0.18,0.21,0.33,0.36,0.38,0.39,0.40,0.41,0.42,0.43,0.45,0.46,0.47,0.49,0.51,0.52,0.54,0.56,0.58,0.62,0.66,0.70,0.72,0.78,0.79,0.81,0.83,0.83,0.82,0.82,0.82,0.82,0.81,0.80,0.76,0.75,0.74,0.72,0.71,0.68,0.64,0.57,0.46,0.42,0.35,0.01,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00];
% Time vector (scaled: 70 = 0.7 seconds)

% Left and Right baseline data
left_baseline = 100 * [0,0.0909090909090909,0.0944395410414828,0.0962047661076787,0.0979699911738747,0.105030891438658,0.105030891438658,0.104148278905560,0.102824360105914,0.101941747572816,0.100176522506620,0.112533097969991,0.115180935569285,0.111209179170344,0.107678729037952,0.105913503971756,0.104589585172109,0.104589585172109,0.102824360105914,0.104148278905560,0.0992939099735216,0.102383053839365,0.102824360105914,0.110326566637246,0.120476610767873,0.144307149161518,0.198587819947043,0.225507502206531,0.249338040600177,0.269196822594881,0.294351279788173,0.306707855251545,0.294792586054722,0.345101500441306,0.353486319505737,0.360547219770521,0.367166813768756,0.372462488967343,0.372021182700794,0.367608120035305,0.363195057369815,0.366284201235658,0.362312444836717,0.357458075904678,0.341129744042365,0.336275375110327,0.296116504854369,0.286849073256840,0.269196822594881,0.244042365401589,0.229920564872021,0.155339805825243,0.152250661959400,0.0441306266548985,0.000882612533097970,0,0,0,0,0,0,0,0];
right_baseline = 85 * [0,0.0403957131079967,0.0684253915910965,0.0746084089035449,0.0791426215993405,0.0972794723825227,0.0981038746908491,0.0968672712283594,0.0964550700741962,0.0964550700741962,0.0956306677658698,0.104286892003298,0.110057708161583,0.107172300082440,0.105111294311624,0.103462489694971,0.101813685078318,0.102225886232481,0.0993404781533388,0.100164880461665,0.0964550700741962,0.0968672712283594,0.0952184666117065,0.0952184666117065,0.0976916735366859,0.103462489694971,0.172300082440231,0.222176422093982,0.293899422918384,0.344600164880462,0.408903544929926,0.443116240725474,0.484748557295960,0.504122011541632,0.511541632316571,0.524319868095631,0.529266281945589,0.532151690024732,0.532976092333059,0.530502885408079,0.523495465787304,0.525556471558120,0.523495465787304,0.513602638087387,0.487221764220940,0.474443528441880,0.403957131079967,0.353256389117890,0.300494641384996,0.215581203627370,0.120362737015664,0.109645507007420,0.00206100577081616,0,0,0.00329760923330585,0.0103050288540808,0.0119538334707337,0.0136026380873866,0,0.0243198680956307,0.0222588623248145,0.0127782357790602];

left_Safety_one_optimized = 100 * [0.00,0.02,0.03,0.04,0.05,0.06,0.06,0.06,0.06,0.06,0.07,0.11,0.13,0.16,0.18,0.19,0.22,0.25,0.29,0.31,0.34,0.37,0.39,0.41,0.44,0.46,0.49,0.52,0.56,0.59,0.62,0.64,0.66,0.68,0.72,0.73,0.73,0.73,0.73,0.72,0.71,0.71,0.70,0.70,0.69,0.67,0.65,0.64,0.62,0.59,0.54,0.45,0.42,0.39,0.21,0.16,0.02,0.05,0.02,0.00,0.00,0.00,0.00];
right_Safety_one_optimized = 100 * [0.00,0.01,0.04,0.04,0.05,0.06,0.06,0.06,0.06,0.06,0.06,0.12,0.16,0.19,0.22,0.25,0.27,0.30,0.33,0.35,0.37,0.41,0.43,0.45,0.47,0.49,0.51,0.54,0.56,0.58,0.61,0.62,0.64,0.67,0.71,0.73,0.74,0.74,0.72,0.70,0.69,0.69,0.68,0.67,0.65,0.63,0.62,0.61,0.58,0.55,0.49,0.36,0.23,0.04,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00];


% Time vector (scaled: 70 = 0.7 seconds)
time = linspace(0, 0.7, length(left_percent_1));

% Compute the average for left and right planes
avg_left = (left_percent_1 + left_percent_2 + left_percent_3) / 3;
avg_right = (right_percent_1 + right_percent_2 + right_percent_3) / 3;

% Compute the standard deviation for shading
std_left = std([left_percent_1; left_percent_2; left_percent_3]);
std_right = std([right_percent_1; right_percent_2; right_percent_3]);

% Create a figure with two subplots, adjust size for smaller height
figure('Position', [100, 100, 1000, 400]);  % Reduce y-dimension to make the figure shorter

% Left plane subplot
subplot(1, 2, 1);
hold on;
% Plot the shaded area for standard deviation
h_std_left = fill([time, fliplr(time)], [avg_left + std_left, fliplr(avg_left - std_left)], [0.8, 0.8, 1], 'EdgeColor', 'none');  % Light blue shading
% Plot the average line
h_avg_left = plot(time, avg_left, 'b-', 'LineWidth', 2);
% Plot left baseline
h_safe_left = plot(time, left_Safety_one_optimized, 'b--', 'LineWidth', 1.5);  % Dashed black line for baseline
h_base_left = plot(time, left_baseline, 'Color', [0.7 0.7 0.7], 'LineWidth', 1.5);  % Dashed grey line for baseline

xlabel('Time (s)');
ylabel('Apposition Percentage (%)');
title('Left Plane');
ylim([0 100]);
grid on;
%legend([h_avg_left, h_std_left, h_base_left, h_safe_left], {'Optimized', 'Standard Deviation', 'Baseline', 'Optimized with SF = 1'}, 'Location', 'best', 'Box', 'off');  % No border around the legend
legend([h_avg_left, h_safe_left,h_base_left], {'Optimized', 'Optimized with SF = 1','Baseline'}, 'Location', 'best', 'Box', 'off');  % No border around the legend

hold off;

% Right plane subplot
subplot(1, 2, 2);
hold on;
% Plot the shaded area for standard deviation
h_std_right = fill([time, fliplr(time)], [avg_right + std_right, fliplr(avg_right - std_right)], [1, 0.8, 0.8], 'EdgeColor', 'none');  % Light red shading
% Plot the average line
h_avg_right = plot(time, avg_right, 'r-', 'LineWidth', 2);
% Plot right baseline
h_safe_right = plot(time, right_Safety_one_optimized, 'r--', 'LineWidth', 1.5);  % Dashed black line for baseline
h_base_right = plot(time, right_baseline, 'Color', [0.7 0.7 0.7], 'LineWidth', 1.5);  % Dashed grey line for baseline

xlabel('Time (s)');
ylabel('Apposition Percentage (%)');
title('Right Plane');
ylim([0 100]);
grid on;
%legend([h_avg_right, h_std_right, h_base_right, h_safe_right], {'Optimized', 'Standard Deviation', 'Baseline', 'Optimized with SF = 1'}, 'Location', 'best', 'Box', 'off');  % No border around the legend
legend([h_avg_right, h_safe_right,h_base_right], {'Optimized', 'Optimized with SF = 1', 'Baseline'}, 'Location', 'best', 'Box', 'off');  % No border around the legend
hold off;